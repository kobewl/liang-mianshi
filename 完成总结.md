# é¡¹ç›®æ”¹è¿›å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„æ‰€æœ‰ä»»åŠ¡

### åç«¯æ”¹è¿›ï¼ˆå·²å®Œæˆ âœ…ï¼‰

#### 1. âœ… å®ç°JWT Tokenè®¤è¯ç³»ç»Ÿ
**æ–‡ä»¶**: `backend/src/main/java/com/mianshi/backend/utils/JwtUtils.java`
- åˆ›å»ºJWTå·¥å…·ç±»ï¼Œå®ç°Tokençš„ç”Ÿæˆã€è§£æå’ŒéªŒè¯
- Tokenæœ‰æ•ˆæœŸï¼š7å¤©
- ä½¿ç”¨HS256ç®—æ³•ç­¾å
- TokenåŒ…å«ï¼šuserIdã€userAccountã€userRole

**æ ¸å¿ƒæ–¹æ³•**:
```java
public static String generateToken(Long userId, String userAccount, String userRole)
public static Claims parseToken(String token)
public static boolean validateToken(String token)
public static Long getUserIdFromToken(String token)
```

#### 2. âœ… åˆ›å»ºè®¤è¯æ‹¦æˆªå™¨
**æ–‡ä»¶**: `backend/src/main/java/com/mianshi/backend/interceptor/AuthInterceptor.java`
- å®ç°HandlerInterceptoræ¥å£
- æ‹¦æˆªæ‰€æœ‰è¯·æ±‚å¹¶éªŒè¯Token
- ä»è¯·æ±‚å¤´ `Authorization: Bearer <token>` è·å–Token
- éªŒè¯å¤±è´¥è¿”å›401é”™è¯¯
- éªŒè¯æˆåŠŸå°†ç”¨æˆ·ä¿¡æ¯å­˜å…¥requestå±æ€§

#### 3. âœ… é…ç½®Webæ‹¦æˆªå™¨
**æ–‡ä»¶**: `backend/src/main/java/com/mianshi/backend/config/WebConfig.java`
- å®ç°WebMvcConfigureræ¥å£
- é…ç½®æ‹¦æˆªå™¨è§„åˆ™
- æ’é™¤ä¸éœ€è¦è®¤è¯çš„è·¯å¾„ï¼š
  - `/api/user/login` - ç™»å½•
  - `/api/user` (POST) - æ³¨å†Œ  
  - `/doc.html` - APIæ–‡æ¡£
  - `/webjars/**` - é™æ€èµ„æº
  - `/swagger-resources/**`
  - `/v3/api-docs/**`

#### 4. âœ… ä¿®æ”¹ç™»å½•é€»è¾‘ç”ŸæˆToken
**æ–‡ä»¶**: `backend/src/main/java/com/mianshi/backend/service/impl/UserServiceImpl.java`
- åœ¨loginæ–¹æ³•ä¸­è°ƒç”¨JwtUtilsç”ŸæˆToken
- ç™»å½•æˆåŠŸåè¿”å›Tokenå’Œç”¨æˆ·ä¿¡æ¯
- UserLoginVOåŒ…å«tokenå­—æ®µ

#### 5. âœ… æ·»åŠ ç”¨æˆ·è®¤è¯ç›¸å…³æ¥å£
**æ–‡ä»¶**: `backend/src/main/java/com/mianshi/backend/controller/UserController.java`
- `GET /api/user/current` - è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
- `POST /api/user/logout` - ç”¨æˆ·ç™»å‡ºï¼ˆå®¢æˆ·ç«¯åˆ é™¤Tokenï¼‰
- ç»Ÿä¸€Controllerè·¯å¾„ä¸º `/api/user`

### å‰ç«¯æ”¹è¿›ï¼ˆå·²å®Œæˆ âœ…ï¼‰

#### 1. âœ… ä¿®å¤APIåŸºç¡€è·¯å¾„é…ç½®
**æ–‡ä»¶**: `frontend/src/api/request.js`
- ä¿®æ”¹baseURLä» `/api` æ”¹ä¸ºæ ¹è·¯å¾„
- ç»Ÿä¸€APIè·¯å¾„è§„åˆ™ï¼Œéœ€è¦è®¤è¯çš„æ¥å£åŠ  `/api` å‰ç¼€
- é…ç½®è¯·æ±‚æ‹¦æˆªå™¨è‡ªåŠ¨æ·»åŠ Token
- é…ç½®å“åº”æ‹¦æˆªå™¨å¤„ç†401é”™è¯¯

#### 2. âœ… ç»Ÿä¸€æ‰€æœ‰APIæ¥å£è·¯å¾„
**ä¿®æ”¹æ–‡ä»¶**:
- `frontend/src/api/user.js` - ç”¨æˆ·ç›¸å…³API
- `frontend/src/api/question.js` - é¢˜ç›®ç›¸å…³API
- `frontend/src/api/questionBank.js` - é¢˜åº“ç›¸å…³API

**è·¯å¾„è§„åˆ™**:
- ç™»å½•/æ³¨å†Œï¼š`/api/user/login`, `/api/user`
- å…¶ä»–æ¥å£ï¼š`/api/user/*`, `/api/question/*`, `/api/question-bank/*`

#### 3. âœ… ä¿®å¤å“åº”codeæ£€æŸ¥
**ä¿®æ”¹æ‰€æœ‰é¡µé¢**:
- `Login.vue` - ç™»å½•é¡µé¢
- `Register.vue` - æ³¨å†Œé¡µé¢
- `UserManage.vue` - ç”¨æˆ·ç®¡ç†
- `QuestionManage.vue` - é¢˜ç›®ç®¡ç†
- `QuestionBankManage.vue` - é¢˜åº“ç®¡ç†
- `store/index.js` - Vuex store

**ä¿®æ”¹å†…å®¹**: `response.code === 0` â†’ `response.code === 200`

#### 4. âœ… ä¿®å¤ç™»å½•è·³è½¬é€»è¾‘
**æ–‡ä»¶**: `frontend/src/views/Login.vue`
- ç™»å½•æˆåŠŸåè·³è½¬åˆ°ä¸»é¡µ `/` è€Œä¸æ˜¯ `/question-banks`
- æ·»åŠ æˆåŠŸæç¤ºä¿¡æ¯ `message.success('ç™»å½•æˆåŠŸï¼')`
- æ”¹è¿›é”™è¯¯å¤„ç†ï¼Œæ˜¾ç¤ºåç«¯è¿”å›çš„å…·ä½“é”™è¯¯ä¿¡æ¯

#### 5. âœ… ä¿®å¤æ³¨å†Œé€»è¾‘
**æ–‡ä»¶**: `frontend/src/views/Register.vue`
- æ³¨å†Œæ—¶å»æ‰ `checkPassword` å­—æ®µï¼ˆåç«¯ä¸éœ€è¦ï¼‰
- ä½¿ç”¨è§£æ„è¯­æ³•è¿‡æ»¤å­—æ®µï¼š`const { checkPassword, ...registerData } = registerForm`
- æ”¹è¿›é”™è¯¯å¤„ç†

#### 6. âœ… Tokenè‡ªåŠ¨ç®¡ç†
**æ–‡ä»¶**: `frontend/src/api/request.js`
- è¯·æ±‚æ‹¦æˆªå™¨è‡ªåŠ¨ä»localStorageè¯»å–token
- è‡ªåŠ¨æ·»åŠ è¯·æ±‚å¤´ï¼š`Authorization: Bearer ${token}`
- å“åº”æ‹¦æˆªå™¨å¤„ç†401é”™è¯¯ï¼Œè‡ªåŠ¨æ¸…é™¤tokenå¹¶è·³è½¬ç™»å½•é¡µ

#### 7. âœ… VuexçŠ¶æ€ç®¡ç†
**æ–‡ä»¶**: `frontend/src/store/index.js`
- ç®¡ç†tokenå’Œç”¨æˆ·ä¿¡æ¯
- login actionä¿å­˜tokenå’Œç”¨æˆ·ä¿¡æ¯
- logout actionæ¸…é™¤tokenå’Œç”¨æˆ·ä¿¡æ¯
- fetchUserInfo actionè·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

#### 8. âœ… è·¯ç”±å®ˆå«
**æ–‡ä»¶**: `frontend/src/router/index.js`
- beforeEachå®ˆå«æ£€æŸ¥token
- éœ€è¦è®¤è¯çš„é¡µé¢æœªç™»å½•è‡ªåŠ¨è·³è½¬ç™»å½•é¡µ
- å·²ç™»å½•è®¿é—®ç™»å½•é¡µè‡ªåŠ¨è·³è½¬ä¸»é¡µ

### UIæ”¹è¿›ï¼ˆå·²å®Œæˆ âœ…ï¼‰

#### 1. âœ… é¡µé¢å¡«å……é—®é¢˜
- Login.vueä½¿ç”¨ `height: 100vh` å¡«å……æ•´ä¸ªå±å¹•
- Home.vueä½¿ç”¨ `min-height: 100vh` å¡«å……æ•´ä¸ªå±å¹•
- App.vueè®¾ç½®å…¨å±€æ ·å¼ç¡®ä¿é¡µé¢å¡«å……

#### 2. âœ… æˆåŠŸæç¤ºå›¾æ ‡
- ç»Ÿä¸€ä½¿ç”¨ `message.success()` æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
- Ant Design Vueçš„messageç»„ä»¶è‡ªåŠ¨æ˜¾ç¤ºç»¿è‰²å¯¹å‹¾å›¾æ ‡
- ç»Ÿä¸€æç¤ºæ–‡æœ¬æ ¼å¼ï¼Œæ·»åŠ æ„Ÿå¹å·å¢å¼ºåé¦ˆ

## ğŸ“ åˆ›å»ºçš„æ–°æ–‡ä»¶

### åç«¯æ–°æ–‡ä»¶
1. `backend/src/main/java/com/mianshi/backend/utils/JwtUtils.java`
2. `backend/src/main/java/com/mianshi/backend/interceptor/AuthInterceptor.java`
3. `backend/src/main/java/com/mianshi/backend/config/WebConfig.java`
4. `backend/Tokenä½¿ç”¨è¯´æ˜.md`

### æ–‡æ¡£æ–‡ä»¶
1. `å‰ç«¯åç«¯æ”¹è¿›è¯´æ˜.md`
2. `å®Œæˆæ€»ç»“.md`

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

### åç«¯ä¿®æ”¹
1. `backend/src/main/java/com/mianshi/backend/controller/UserController.java`
   - æ·»åŠ  `/current` å’Œ `/logout` æ¥å£
   - ä¿®æ”¹RequestMappingä¸º `/api/user`

2. `backend/src/main/java/com/mianshi/backend/service/impl/UserServiceImpl.java`
   - ä¿®æ”¹loginæ–¹æ³•ï¼Œæ·»åŠ Tokenç”Ÿæˆé€»è¾‘

### å‰ç«¯ä¿®æ”¹
1. `frontend/src/api/request.js` - ä¿®æ”¹baseURL
2. `frontend/src/api/user.js` - ç»Ÿä¸€APIè·¯å¾„
3. `frontend/src/api/question.js` - ç»Ÿä¸€APIè·¯å¾„
4. `frontend/src/api/questionBank.js` - ç»Ÿä¸€APIè·¯å¾„
5. `frontend/src/views/Login.vue` - ä¿®å¤codeæ£€æŸ¥å’Œè·³è½¬
6. `frontend/src/views/Register.vue` - ä¿®å¤codeæ£€æŸ¥å’Œæ³¨å†Œé€»è¾‘
7. `frontend/src/views/UserManage.vue` - ä¿®å¤codeæ£€æŸ¥
8. `frontend/src/views/QuestionManage.vue` - ä¿®å¤codeæ£€æŸ¥
9. `frontend/src/views/QuestionBankManage.vue` - ä¿®å¤codeæ£€æŸ¥
10. `frontend/src/store/index.js` - ä¿®å¤codeæ£€æŸ¥

## ğŸ§ª æµ‹è¯•æ¸…å•

### æµ‹è¯•æ­¥éª¤
1. âœ… **å¯åŠ¨åç«¯**: `cd backend && mvn spring-boot:run`
2. âœ… **å¯åŠ¨å‰ç«¯**: `cd frontend && npm install && npm run dev`
3. âœ… **æµ‹è¯•æ³¨å†Œ**: è®¿é—®æ³¨å†Œé¡µé¢ï¼Œåˆ›å»ºæ–°ç”¨æˆ·
4. âœ… **æµ‹è¯•ç™»å½•**: ä½¿ç”¨æ³¨å†Œçš„è´¦å·ç™»å½•
5. âœ… **æµ‹è¯•Token**: æ£€æŸ¥localStorageä¸­çš„token
6. âœ… **æµ‹è¯•è®¤è¯**: è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢
7. âœ… **æµ‹è¯•ç™»å‡º**: ç‚¹å‡»ç™»å‡ºæŒ‰é’®
8. âœ… **æµ‹è¯•æ‹¦æˆª**: æ¸…é™¤tokenåè®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢

### æµ‹è¯•è´¦å·
- è´¦å·ï¼šwangliang
- å¯†ç ï¼š123456
- æˆ–ä½¿ç”¨æ³¨å†ŒåŠŸèƒ½åˆ›å»ºæ–°è´¦å·

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. âœ… JWT Tokenç­¾åéªŒè¯
2. âœ… Tokenè¿‡æœŸæ—¶é—´æ§åˆ¶ï¼ˆ7å¤©ï¼‰
3. âœ… 401é”™è¯¯è‡ªåŠ¨å¤„ç†
4. âœ… Tokenå­˜å‚¨åœ¨localStorage
5. âœ… è¯·æ±‚æ‹¦æˆªå™¨è‡ªåŠ¨æ·»åŠ Token
6. âœ… å“åº”æ‹¦æˆªå™¨ç»Ÿä¸€é”™è¯¯å¤„ç†

## ğŸ¯ æŠ€æœ¯è¦ç‚¹

### Tokenæ ¼å¼
```
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VySWQiOjEsInVzZXJBY2NvdW50Ijoid2FuZ2xpYW5nIiwidXNlclJvbGUiOiJ1c2VyIiwic3ViIjoid2FuZ2xpYW5nIiwiaWF0IjoxNzM0MTY4MDAwLCJleHAiOjE3MzQ3NzI4MDB9.signature
```

### Tokenå†…å®¹
```json
{
  "userId": 1,
  "userAccount": "wangliang",
  "userRole": "user",
  "sub": "wangliang",
  "iat": 1734168000,
  "exp": 1734772800
}
```

### APIå“åº”æ ¼å¼
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "userAccount": "wangliang",
    "userName": "ç‹äº®",
    "token": "eyJhbGciOiJIUzI1NiJ9..."
  }
}
```

## ğŸ“‹ åç»­ä¼˜åŒ–å»ºè®®

### é«˜ä¼˜å…ˆçº§
1. å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆBCryptï¼‰
2. Tokenåˆ·æ–°æœºåˆ¶ï¼ˆrefresh tokenï¼‰
3. HTTPSéƒ¨ç½²

### ä¸­ä¼˜å…ˆçº§
1. Tokené»‘åå•ï¼ˆRedisï¼‰
2. åˆ†å¸ƒå¼Session
3. é™æµå’Œé˜²é‡æ”¾æ”»å‡»
4. æ—¥å¿—è®°å½•

### ä½ä¼˜å…ˆçº§
1. å¤šç«¯ç™»å½•æ§åˆ¶
2. ç™»å½•å†å²è®°å½•
3. å¼‚å¸¸ç™»å½•æé†’
4. Tokenç»­æœŸç­–ç•¥

## âœ¨ é¡¹ç›®äº®ç‚¹

1. **å®Œå…¨è‡ªå®ç°**: æ²¡æœ‰ä½¿ç”¨Spring Securityç­‰æ¡†æ¶ï¼Œå®Œå…¨è‡ªå·±å®ç°Tokenè®¤è¯
2. **ä»£ç ç®€æ´**: JWTå·¥å…·ç±»å’Œæ‹¦æˆªå™¨ä»£ç æ¸…æ™°æ˜“æ‡‚
3. **å‰åç«¯åˆ†ç¦»**: å®Œå…¨çš„å‰åç«¯åˆ†ç¦»æ¶æ„
4. **ç»Ÿä¸€è§„èŒƒ**: APIè·¯å¾„ã€å“åº”æ ¼å¼ã€é”™è¯¯å¤„ç†éƒ½ç»Ÿä¸€è§„èŒƒ
5. **ç”¨æˆ·ä½“éªŒ**: ç™»å½•çŠ¶æ€æŒä¹…åŒ–ï¼ŒTokenè‡ªåŠ¨ç®¡ç†
6. **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡æ”¹è¿›å®Œæˆäº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š
- âœ… å®ç°äº†å®Œæ•´çš„JWT Tokenè®¤è¯ç³»ç»Ÿ
- âœ… ä¿®å¤äº†æ‰€æœ‰å‰ç«¯APIè·¯å¾„é—®é¢˜
- âœ… ç»Ÿä¸€äº†å‰åç«¯å“åº”ç å¤„ç†
- âœ… æ”¹è¿›äº†ç”¨æˆ·ä½“éªŒå’Œé”™è¯¯æç¤º
- âœ… å®Œå–„äº†è·¯ç”±å®ˆå«å’Œæƒé™æ§åˆ¶
- âœ… ä¼˜åŒ–äº†é¡µé¢å¸ƒå±€å’ŒUIæ•ˆæœ

ç³»ç»Ÿç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå…·å¤‡å®Œæ•´çš„ç”¨æˆ·è®¤è¯å’ŒæˆæƒåŠŸèƒ½ï¼

## ğŸ“ ä½¿ç”¨è¯´æ˜

### é¦–æ¬¡ä½¿ç”¨
1. å¯åŠ¨åç«¯æœåŠ¡ï¼ˆç«¯å£8184ï¼‰
2. å¯åŠ¨å‰ç«¯æœåŠ¡ï¼ˆç«¯å£5173ï¼‰
3. è®¿é—® http://localhost:5173/register æ³¨å†Œè´¦å·
4. æ³¨å†ŒæˆåŠŸåè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ
5. ç™»å½•æˆåŠŸåå¯ä»¥ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½

### å¼€å‘è°ƒè¯•
- åç«¯APIæ–‡æ¡£ï¼šhttp://localhost:8184/doc.html
- å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼šhttp://localhost:5173
- æµè§ˆå™¨æ§åˆ¶å°å¯æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…
- LocalStorageå¯æŸ¥çœ‹Tokenä¿¡æ¯

### å¸¸è§é—®é¢˜
1. ç™»å½•å¤±è´¥ï¼šæ£€æŸ¥è´¦å·å¯†ç æ˜¯å¦æ­£ç¡®
2. Tokenè¿‡æœŸï¼šé‡æ–°ç™»å½•å³å¯
3. 401é”™è¯¯ï¼šä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ
4. ç½‘ç»œé”™è¯¯ï¼šæ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨

